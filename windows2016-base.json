{
  "builders": [{
    "name": "windows2016-{{isotime \"2006-01-02\"}}",
    "vm_name": "windows2016-{{isotime \"2006-01-02\"}}",
    "type": "vmware-iso",
    "guest_os_type": "windows9srv-64",
    "output_directory": "./output/windows2016-{{isotime \"2006-01-02\"}}",
    "http_directory": "http",

    "headless": true,
    "iso_checksum": "sha256:47919ce8b4993f531ca1fa3f85941f4a72b47ebaa4d3a321fecf83ca9d17e6b8",
    "iso_url": "https://nas.balmerfamilyfarm.com:9000/public/microsoft/SW_DVD9_WIN_SERVER_STD_CORE_2016_64BIT_ENGLISH_-4_DC_STD_MLF_X21-70526.ISO",

    "communicator":"winrm",
    "winrm_username": "administrator",
    "winrm_password": "ansible",
    "winrm_timeout": "12h",
    "winrm_use_ntlm": true,
    "winrm_use_ssl": true,
    "winrm_insecure": true,

    "cpus": 2,
    "cores": 1,
    "memory": 4096,
    "disk_adapter_type": "lsisas1068",
    "version": "11",

    "vmx_data_post": {
      "ethernet0.virtualDev": "vmxnet3"
    },

    "shutdown_command": "shutdown /s /t 10 /f /d p:4:1 /c \"Packer Shutdown\"",
    "shutdown_timeout": "4h",
    "floppy_files": [
      "scripts/2016-standard/autounattend.xml",
      "scripts/microsoft-updates.bat",
      "scripts/win-updates.ps1",
      "scripts/software/ansible.ps1"
     ]
  }],
  "provisioners": [
    {
      "type": "powershell",
      "script": "scripts/software/vmware.ps1"
    },
    {
      "type": "powershell",
      "script": "scripts/smb.ps1"
    },
    {
      "type": "powershell",
      "script": "scripts/rdp.ps1"
    },
    {
      "type": "powershell",
      "script": "scripts/cleanup.ps1"
    }
  ],
  "post-processors": [
      [
        {
          "type": "shell-local",
          "inline": [
            "ovftool --diskMode=thin --name=\"windows2016-{{isotime \"2006-01-02\"}}\" --annotation=\"{{isotime \"2006-01-02\"}}\" \"output/windows2016-{{isotime \"2006-01-02\"}}/windows2016-{{isotime \"2006-01-02\"}}.vmx\" \"output/windows2016-{{isotime \"2006-01-02\"}}.ova\""
          ]
        }
      ]
  ]
}
